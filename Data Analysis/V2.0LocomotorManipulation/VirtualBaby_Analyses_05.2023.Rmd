---
title: "Analyzing Locomotor Baby"
date: "May 2023 (revisiting on 10/09/2023)"
output: word_document
---

## Brief Description of Document
*This document is a stable markdown file that allows me to reproduce analyses and figures in report form. The most up to date raw data is currently being stored on GitHub at BabyLab/VirtualBaby-ParentPerception.*

*Note: By distributing the raw .Rmd file, one can use* `include=TRUE` *to include output, or* `echo=TRUE` *to include code. i.e., this report can be catered to different audiences without changing any of the contents. To generate a word output of the results, you can "knit" this file immediately.*

**Virtual Baby (VB)** has 2 main hypotheses: 

* Parents are more likely to rate oncoming threats (a car) as moving faster when the virtual infant matches their own infant's mature locomotor skills
* Parents are more likely to detect oncoming threats faster when the virtual infant matches their own infant's mature locomotor skills

## Setting up
*Hidden code*: To import necessary R packages and files. Files are pulled from local clone of GitHub repository.
```{r library, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
#library
library(knitr)
library(tibble)
library(dplyr) #please do not load plyr!
library(tidyr)
library(scales)
library(ggplot2)
library(emmeans)
library(lme4)
library(ggridges)
library(lmerTest)
library(rmarkdown)
library(forcats)
library(effectsize)
```

```{r df, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
df <- read.csv("C:/Users/emmam/Documents/GitHub/VirtualBaby-ParentPerception/Data Analysis/V2.0LocomotorManipulation/Unity/combined_unity.csv")
demos <- read.csv("C:/Users/emmam/Documents/GitHub/VirtualBaby-ParentPerception/Data Analysis/V2.0LocomotorManipulation/demos.csv")
```

## Cleaning The Data (Pre-Processing)
*Description:* These were the steps taken to get the data in the right format for analysis. 

* The `demos` file was pre-cleaned by removing pilots, removing extra qualtrics headers, and adding ID and Condition (according to experimenter log)

*Hidden Code*: For the following process

* remove sloppy data (i.e., due to game glitches, parents stopping the study, or in-person infant fussiness)
* Creating sum variables for PROMIS scores (depression & anxiety)
* Reducing demos to vars of interest (age, gender, race, primary_language, anxiety, depression, videogames, relationship, number_children, baby_mobility, breastfeed)
* Creating a merged dataset that combines demographic info and gameplay info


```{r demos_prep, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
demos <- demos %>% 
  filter(id != 103) %>% #accidental write over
  filter(id != 104) %>% #baby fuss-out
  filter(id != 105) %>% #accidental write-over; confused with 106
  filter(id != 106) %>% #accidental write-over; confused with 105
  filter(id >= 100) %>% #old zoom data from before 2.0
  filter(id != 169) %>% #buggy game
  filter(id != 172) %>% #buggy game; non-serious participant
  filter(id != 189) %>% #baby fuss-out
  filter(id != 191) %>% #baby fuss-out
  filter(id != 205) %>% #baby fuss-out
  filter(id != 206) %>% #baby fuss-out
  filter(id != 189) %>% #baby fuss-out
  filter(id != 199) %>% #method change
  filter(id != 202) %>% #method change
  filter(id != 204) %>% #method change
  filter(id != 208) #method change

demos <- demos %>% mutate('anxiety' = PROMIS_1 + PROMIS_2 + PROMIS_3 + PROMIS_4 + PROMIS_5 + PROMIS_6 + PROMIS_7 + PROMIS_8) %>%  mutate('depression' = PROMIS_9 + PROMIS_10 + PROMIS_11
+ PROMIS_12 + PROMIS_13 + PROMIS_14 + PROMIS_15 + PROMIS_16)

#(easy to add more as needed, just be sure to change the loop below too)
demos <- demos %>% select(id, subcondition, age, gender, race, primary_language, anxiety, depression, videogames, relationship, number_children, baby_mobility, breastfeed)
df <- df %>% 
  add_column(age = NA, gender = NA, race = NA, primary_language = NA, anxiety = NA, 
             depression = NA, videogames = NA, relationship = NA, number_children = NA, baby_mobility = NA, breastfeed = NA, )
```

```{r relabelingdemos, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
#relabeling factors to make codes prettier
demos$subcondition <- recode(demos$subcondition, n="Non-Parent", p="Parent")
df$subcondition <- recode(df$subcondition, n="Non-Parent", N="Non-Parent", p="Parent", P="Parent")
demos$gender <- as.factor(demos$gender)
demos$gender <- recode(demos$gender, "1"="Male", "2"="Female")
demos$race <- recode(demos$race, "1"="Black", "2"="White", "3"="S. Asian", "4" = "Am. Native", "5"= "Pacific Islander", 
                     "6"="Other", "7"="E. Asian", "8"="M.Eastern", "9"="Hispanic/Latino", "2,7"="White/Other", "2,9"="White/Other", "1,9" = "Black/Hispanic", "1.2" = "Black/White")
demos$white <-recode(demos$race, "White" = "1", .default = "0")
demos$videogames <-recode(demos$videogames, "1" = "Experienced", "2" = "Inexperienced")
demos$relationship <- recode(demos$relationship, "1"="Married", "2"="Widowed", "3"="Separated", "4" = "Never Married", "5"= "In a Relationship", "6"="Cohabiting", "7"="Single", "4,7" = "Single", "1,3,6" = "Cohabiting", "4,5" = "In a Relationship", "5,6" = "Cohabiting", "1,5" = "Married", "1,6" = "Married", "1,3" = "Married")
demos$baby_mobility<-recode(demos$baby_mobility, "1"="Pre-Crawl", "1,2" = "Pre-Crawl", "1,4" = "Pre-Crawl", "1,2,3" = "Crawl", "2,3" = "Crawl", "1,2,3,4" = "Crawl", "1,2,3,4,5" = "Walk", "5" = "Walk", "6" = "Pre-Crawl", "1,3" = "Crawl", "2" = "Pre-Crawl", "2,3,5" = "Walk", "2,3,4" = "Crawl", "3,4" = "Crawl", "3" = "Crawl") %>% na_if("") %>% replace_na("Non-Parent")
demos$breastfeed <- recode(demos$breastfeed, "1" = "Yes, in the past", "2"="Yes, currently", "3"="No, Never")
```

```{r merge, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
#have to prep the original dataset to make sure the same participants are getting excluded across both
df <- df %>% 
  filter(id != 103) %>% #accidental write over
  filter(id != 104) %>% #baby fuss-out
  filter(id != 105) %>% #accidental write-over; confused with 106
  filter(id != 106) %>% #accidental write-over; confused with 105
  filter(id >= 100) %>% #old zoom data from before 2.0
  filter(id != 169) %>% #buggy game
  filter(id != 172) %>% #buggy game; non-serious participant
  filter(id != 189) %>% #baby fuss-out
  filter(id != 191) %>% #baby fuss-out
  filter(id != 205) %>% #baby fuss-out
  filter(id != 206) %>% #baby fuss-out
  filter(id != 189) %>% #baby fuss-out
  filter(id != 199) %>% #method change
  filter(id != 202) %>% #method change
  filter(id != 204) %>% #method change
  filter(id != 208) #method change


#need to make sure that the column that the two are merging on are of the same type
df$id <- as.factor(df$id)
demos$id <- as.factor(demos$id)

#the loop that  the two files using "id" as the anchor
#warning: this can take a few minutes since the df file is getting big
for(i in 1:dim(df[1])){
  for(j in 1:dim(demos[1])){
    if(df$id[i] == demos$id[j]){
      df$age[i] = demos$age[j] 
      df$gender[i] = demos$gender[j] 
      df$race[i] = demos$race[j] 
      df$primary_language[i] = demos$primary_language[j] 
      df$anxiety[i] = demos$anxiety[j] 
      df$depression[i] = demos$depression[j]
      df$videogames[i] = demos$videogames[j]
      df$relationship[i] = demos$relationship[j]
      df$number_children[i] = demos$number_children[j]
      df$baby_mobility[i] = demos$baby_mobility[j]
      df$breastfeed[i] = demos$breastfeed[j]
    }
  }
}

#later i will need this code. for some reason I was unable to relable "NA"s in 
#the later datafiles "JustRTs" and "JustSpeeds"
df$mobility[is.na(df$mobility)] <- "nobaby"
```



## Demographic Descriptives
*Description*: A series of tables that break down the demographic information of the different subjects. There is still data to be analyzed, but requires additional data pre-processing.

Special note about how infant locomotor status is characterized: If the child cannot perform the action unassisted, it does not count. For example, if the infant cannot walk without aid (e.g., parent's walking them or cruising), then it was counted as crawling (provided the infant could crawl as well). This could have interesting implications if broken down further.

```{r counts, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
demos %>% group_by(baby_mobility) %>% 
  summarise(Count=n()) %>% 
  kable(., digits = 2, caption = "Total Subject Count per Condition")

```

```{r demos, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
demos$age <- recode(demos$age, "4-Jan" = "41") #thanks excel
demos$age <- as.numeric(demos$age)
demos %>%
  group_by(subcondition) %>% 
  summarise(Mean=mean(age), Min=min(age), Max=max(age), Median=median(age), SD=sd(age)) %>% 
  kable(., digits = 2, caption = "Age Descriptives")


demos %>%
  group_by(subcondition, gender) %>% 
  summarise(Count=n()) %>% 
  mutate(Proportion = prop.table(Count)*100) %>% 
  kable(., digits = 2, caption = "Gender Descriptives")

#demos %>%
#  group_by(baby_mobility, race) %>% 
#  summarise(Count=n()) %>% 
#  mutate(Proportion = prop.table(Count)*100) %>% 
#  kable(., digits = 2, caption = "Race Descriptives")
demos %>%
  group_by(subcondition, white) %>% 
  summarise(Count=n()) %>% 
  mutate(Proportion = prop.table(Count)*100) %>% 
  kable(., digits = 2, caption = "Race Descriptives (Identifying as White Only)")

demos %>%
  filter(!is.na(anxiety)) %>% 
  group_by(subcondition) %>% 
  summarise(Mean=mean(anxiety), Min=min(anxiety), Max=max(anxiety), Median=median(anxiety), SD=sd(anxiety)) %>% 
  kable(., digits = 2, caption = "Anxiety Scores (higher = more symptoms)")
demos %>%
  filter(!is.na(depression)) %>% 
  group_by(subcondition) %>%
  summarise(Mean=mean(depression), Min=min(depression), Max=max(depression), Median=median(depression), SD=sd(depression)) %>% 
  kable(., digits = 2, caption = "Depression Scores (higher = more symptoms)")

demos %>%
  group_by(subcondition, videogames) %>% 
  summarise(Count=n()) %>% 
  mutate(Proportion = prop.table(Count)*100) %>% 
  kable(., digits = 2, caption = "Videogame Descriptives")

demos %>%
  group_by(subcondition, relationship) %>% 
  summarise(Count=n()) %>% 
  mutate(Proportion = prop.table(Count)*100) %>% 
  kable(., digits = 2, caption = "Relationship Descriptives")
```


### Parent-Only Demographics
```{r babydemos, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
demos %>% 
  filter(subcondition == "Parent") %>% 
  group_by(number_children) %>% 
  summarise(Count=n()) %>%  
  kable(., digits = 2, caption = "Number of Children")

demos %>% 
  filter(subcondition == "Parent") %>% 
  group_by(breastfeed) %>% 
  summarise(Count=n()) %>%  
  kable(., digits = 2, caption = "Does Baby Breastfeed?")
```

Other demographics not listed here include **English as Primary Language**, **Education**, **Ages of Other Children**, **Partner Demographics**, **Baby Health Complications**, **Baby Mood**, **Hours with Caretaker**, **Debriefs about Strategies and Feelings**

```{r subdifferences, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
#need to run all this stuff on demos only

demos$age <- as.numeric(demos$age)
lm_subXage <- lm(age ~ subcondition, data = demos)
summary(lm_subXage)

chisq.test(demos$gender, demos$subcondition)

chisq.test(demos$race, demos$subcondition)

chisq.test(demos$relationship, demos$subcondition)
chisq.test(demos$videogames, demos$subcondition)

lm_subXanxiety <- lm(anxiety ~ subcondition , data = demos)
summary(lm_subXanxiety)

lm_subXdepression <- lm(depression ~ subcondition, data = demos)
summary(lm_subXdepression)
```


## Main DV's

### Reaction Time (Threat *Detection*)
**Description**: This DV reflects time from car onset to first SPACE PRESSED (i.e., RT to car detection). Notably, it does not measure error time, because participants have freedom to move their cameras and there are also some obstacles obscuring the car at start. It is only a measure of RT that can be compared between groups. 

*Hidden code*: to describe the following

* Isolating "true" trials to be kept for analysis, meaning that each trial has only one instance of "Car Start", "Space Pressed" and "Car End" each
* Representing missed and spammed trials
* Calculate speed for "Car Start" - "Space Pressed" (RT)

```{r isolatingtruetrials, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
#making a unique code to identify rows easier
df <-df %>% mutate ("uniquecode" = paste(subcondition, id, trial, carspeed, mobility))
#(note: old code used block codes instead of mobility, but mobility is more reliable here since the block name doesn't change between different baby scenes in this version)
df <-df %>% mutate ("xtra_uniquecode" = paste(subcondition, id, trial, carspeed, mobility, timenow))

#isolating a variable I can use for later (Bpresses) before changing what df is (i.e., autosave)
df_pretrues <- df

#isolating the three critical events of each trial so that we have ONLY 3 per trial
#the 3 critical events are selected by removing other instances in the same trial in later rows
df_scores <- df %>% filter(eventname == "Score (Space Pressed)")
df_carstart <- df %>% filter(eventname == "Car Starts")
df_carend <- df %>% filter(eventname == "Car Ends")

#df of just the first unique instance of each event
df_uniquescores <- df_scores %>% distinct(eventname, uniquecode, .keep_all = TRUE)
df_uniquestarts <- df_carstart %>% distinct(eventname, uniquecode, .keep_all = TRUE)
df_uniqueends <- df_carend %>% distinct(eventname, uniquecode, .keep_all = TRUE)


#df of just events that are to be filtered out for being anything but the first instance
df_scoredupes <- df_scores[!df_scores$xtra_uniquecode %in% df_uniquescores$xtra_uniquecode,]
df_startdupes <- df_carstart[!df_carstart$xtra_uniquecode %in% df_uniquestarts$xtra_uniquecode,]
df_enddupes <- df_carend[!df_carend$xtra_uniquecode%in% df_uniqueends$xtra_uniquecode,]

#removing the filtered df from the main df
df <- df[!df$xtra_uniquecode %in% df_scoredupes$xtra_uniquecode,]
df <- df[!df$xtra_uniquecode %in% df_startdupes$xtra_uniquecode,]
df <- df[!df$xtra_uniquecode %in% df_enddupes$xtra_uniquecode,]
```

```{r RTs, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
df$timenow <- as.numeric(df$timenow)

JustRTs <- df %>% 
  filter(eventname == "Score (Space Pressed)" | eventname == "Car Starts") %>% 
  mutate(timesincecarstart = timenow - lag(timenow, default = first(timenow))) %>% 
  filter(eventname == "Score (Space Pressed)" & timesincecarstart < 10) %>%  #filters out RT outliers due to trial gaps 
  filter(timesincecarstart >=0)
```

#### Spams and Whiffs
Averages for trials where participants spammed space or missed the car entirely.

```{r missedtrials, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
#trials where the subject pressed space more than once
  df_scoredupes %>% 
  group_by(id, baby_mobility, mobility) %>% 
  summarise(SpacePresses = n()) %>% 
  filter(SpacePresses < 36) %>% 
  group_by(baby_mobility, mobility) %>%
  summarise(AverageExtraSpacePresses = mean(SpacePresses)) %>% 
  kable(., digits = 2, caption = "Average number of additional space presses")
scoredupes <- 
  df_scoredupes %>% 
  group_by(id, baby_mobility, mobility) %>% 
  summarise(SpacePresses = n()) %>% 
  filter(SpacePresses < 36) %>% 
  group_by(baby_mobility, mobility)

ggplot(scoredupes, aes(x=mobility, y=SpacePresses, fill = baby_mobility)) + geom_boxplot()

#trials where the subject failed to press space
df_scores %>% 
  filter(responsename == 15 | responsename == 25 | responsename == 35) %>%
  select(id, baby_mobility, mobility, trial, responsename) %>% 
  mutate(misses = as.numeric(trial) - 10) %>% 
  filter(misses > 0) %>% 
  group_by(baby_mobility, mobility) %>% 
  summarise(AverageTrialsMissed = mean(misses)) %>% 
  kable(., digits = 2, caption = "Average number of trials subject failed to wave the car")
scores<-df_scores %>% 
  filter(responsename == 15 | responsename == 25 | responsename == 35) %>%
  select(id, baby_mobility, mobility, trial, responsename) %>% 
  mutate(misses = as.numeric(trial) - 10) %>% 
  filter(misses > 0) %>% 
  group_by(baby_mobility, mobility)
ggplot(scores, aes(x=mobility, y=misses, fill = baby_mobility)) + geom_boxplot()
```


#### RT predicted by virtual baby presence/type
**Description**: Regression model where RT is predicted by virtual infant mobility and random effects ID.

```{r RTsgraph1, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
JustRTs$mobility <- as.factor(JustRTs$mobility)
JustRTs$baby_mobility <- as.factor(JustRTs$baby_mobility)

RT.se.summary <- JustRTs %>% 
  group_by(mobility, baby_mobility) %>% #within block and subject and parental status
  summarise(
    sd = sd(timesincecarstart),
    se = sqrt(var(timesincecarstart)/length(timesincecarstart)),
    mean = mean(timesincecarstart), 
    alpha=0.05, 
    t=qt((1-alpha)/2 + .5, 
    length(JustRTs$timesincecarstart)-1), 
    CI=t*se) %>% 
  mutate(relabeled_groups = fct_recode(mobility, 
                                       "No Baby" = "nobaby", 
                                       "Precrawling" = "precrawler", 
                                       "Crawling" = "crawler", 
                                       "Walking" = "walker")) %>% 
  mutate(relabeled_groups = fct_relevel(relabeled_groups, 
                                        "No Baby", 
                                        "Precrawling",
                                        "Crawling",
                                        "Walking "
                                        ))%>% 
  #filter(baby_mobility != "Non-Parent") %>% 
  mutate(baby_mobility = fct_recode(baby_mobility, 
                                    "Non-Parent" = "Non-Parent",
                                    "Crawler" = "Crawl", 
                                    "Walker" = "Walk",
                                    "Pre-Crawler" = "Pre-Crawl")) %>% 
  mutate(baby_mobility = fct_relevel(baby_mobility, 
                                     "Non-Parent",
                                     "Pre-Crawler", 
                                     "Crawler", 
                                     "Walker"))


plot <- ggplot(RT.se.summary, aes(x=relabeled_groups, y = mean, ymin = mean-CI, ymax = mean+CI, group = baby_mobility, color = baby_mobility, fill = baby_mobility)) +
  #geom_line(size = 1.5) +
  #geom_point(size = 3) +
  geom_bar(stat = "identity", position = position_dodge()) + 
  geom_errorbar(size = 1, width = 0.2, position = position_dodge(0.9), color = "gray4") +
  xlab("Virtual Infant Condition") + ylab("Average Reaction Time (s)") + 
  scale_color_manual(name = "Parents of a...", values = c("black","blueviolet", "chartreuse3","deepskyblue2")) +
  scale_fill_manual(name = "Parents of a...", values = c("azure4","blueviolet", "chartreuse3","deepskyblue2")) +
  theme_classic() + 
    coord_cartesian(ylim=c(0,2.5)) +
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))
plot
  


RT.se.summary2 <- JustRTs %>% 
  group_by(mobility, subcondition) %>% #within block and subject and parental status
  summarise(
    sd = sd(timesincecarstart),
    se = sqrt(var(timesincecarstart)/length(timesincecarstart)),
    mean = mean(timesincecarstart), 
    alpha=0.05, 
    t=qt((1-alpha)/2 + .5, 
    length(JustRTs$timesincecarstart)-1), 
    CI=t*se) %>% 
  mutate(relabeled_groups = fct_recode(mobility, 
                                       "No Baby" = "nobaby", 
                                       "Precrawling" = "precrawler", 
                                       "Crawling" = "crawler", 
                                       "Walking" = "walker")) %>% 
  mutate(relabeled_groups = fct_relevel(relabeled_groups, 
                                        "No Baby", 
                                        "Precrawling",
                                        "Crawling",
                                        "Walking"
                                        )) 


plot2 <- ggplot(RT.se.summary2, aes(x=relabeled_groups, y = mean, ymin = mean-CI, ymax = mean+CI, group = subcondition, color = subcondition, fill = subcondition)) +
  # geom_line(size = 1.5) +
  # geom_point(size = 3) +
  geom_bar(stat = "identity", position = position_dodge()) + 
  geom_errorbar(size = 1, width = 0.2, position = position_dodge(0.9), color = "gray4") +
  xlab("Virtual Infant Condition") + ylab("Average Reaction Time (s)") + 
 scale_color_manual(name = "Parental Experience", values = c("blue", "goldenrod3")) +
  scale_fill_manual(name = "Parental Experience", values = c("blue", "goldenrod3")) +
  coord_cartesian(ylim=c(0, 2.5)) +
  theme_classic() + 
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))
plot2

#note: a good print size is: 
#1000 maintained ratio
#then 1000x1000 losing maintained ratio
#can cut out the key later for tidying up
```

```{r RTsgraphbycondition, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
#breaking it into condition to see more clearly
crawlers <- RT.se.summary %>% filter(baby_mobility == "Crawl")
walkers <- RT.se.summary %>% filter(baby_mobility == "Walk")
precrawl <- RT.se.summary %>% filter(baby_mobility == "Pre-Crawl")
nonparent <- RT.se.summary %>% filter(baby_mobility == "Non-Parent")


ggplot(crawlers, aes(x=relabeled_groups, y = mean, ymin = mean-se, ymax = mean+se, group = baby_mobility, color = baby_mobility)) +
  geom_line(size = 1.5) +
  geom_point(size = 3) +
  geom_errorbar(
                size = 1, width = 0.2) +
  xlab("Virtul Infant Condition") + ylab("Average Reaction Time (s)") + 
  scale_color_discrete(name = "Parents of...", labels=c('Crawlers')) + 
 # scale_color_manual(name = "mobility", values = c("red", "black", "chartreuse3","blue")) +
  ylim(1.5,2.6) +
  theme_classic() + 
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))
 
ggplot(walkers, aes(x=relabeled_groups, y = mean, ymin = mean-se, ymax = mean+se, group = baby_mobility, color = baby_mobility)) +
  geom_line(size = 1.5) +
  geom_point(size = 3) +
  geom_errorbar(
                size = 1, width = 0.2) +
  xlab("Virtul Infant Condition") + ylab("Average Reaction Time (s)") + 
  scale_color_discrete(name = "Parents of...", labels=c('Walkers')) + 
 # scale_color_manual(name = "mobility", values = c("red", "black", "chartreuse3","blue")) +
  ylim(1.5,2.6) +
  theme_classic() + 
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))

ggplot(precrawl, aes(x=relabeled_groups, y = mean, ymin = mean-se, ymax = mean+se, group = baby_mobility, color = baby_mobility)) +
  geom_line(size = 1.5) +
  geom_point(size = 3) +
  geom_errorbar(
                size = 1, width = 0.2) +
  xlab("Virtul Infant Condition") + ylab("Average Reaction Time (s)") + 
  scale_color_discrete(name = "Parents of...", labels=c( 'Pre-Crawlers')) + 
 # scale_color_manual(name = "mobility", values = c("red", "black", "chartreuse3","blue")) +
  ylim(1.5,2.6) +
  theme_classic() + 
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))

ggplot(nonparent, aes(x=relabeled_groups, y = mean, ymin = mean-se, ymax = mean+se, group = baby_mobility, color = baby_mobility)) + geom_line(size = 1.5) + geom_point(size = 3) +
  geom_errorbar(size = 1, width = 0.2) +
  xlab("Virtul Infant Condition") + ylab("Average Reaction Time (s)") + 
  scale_color_discrete(name = "Parents of...", labels=c('No Children')) + 
 # scale_color_manual(name = "mobility", values = c("red", "black", "chartreuse3","blue")) +
  ylim(1.5,2.6) +
  theme_classic() + 
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))
```

```{r RTtest1, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_RTnull <-lmer(timesincecarstart ~ (1|id), data = JustRTs)
lm_RT1 <- lmer(timesincecarstart ~  mobility + (1|id), data = JustRTs)
```

```{r RTtestemmeans1, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_RT1, "mobility", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Virtual Infant Type")
```

#### RT predicted by parental experience
**Description**: Regression model where RT is predicted by the mobility of the parent's infant and a random effects of ID.

```{r RTsgraph2, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
#All for dem sweet sweet spaghetti plots
NonParent_RT_MeansByID <- JustRTs %>% 
  filter(baby_mobility == "Non-Parent") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(timesincecarstart))
Precrawler_RT_MeansByID <- JustRTs %>% 
  filter(baby_mobility == "Sit") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(timesincecarstart))
Crawler_RT_MeansByID <- JustRTs %>% 
  filter(baby_mobility == "Crawl") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(timesincecarstart))
Walker_RT_MeansByID <- JustRTs %>% 
  filter(baby_mobility == "Walk") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(timesincecarstart))
RT_MeansByCond <- JustRTs %>% 
  group_by(baby_mobility, mobility) %>% 
  summarize(mean = mean(timesincecarstart))


ggplot(Precrawler_RT_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Average Reaction Time") + ggtitle("RTs of PreCrawler Parents") 
ggplot(Crawler_RT_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Average Reaction Time") + ggtitle("RTs of Crawler Parents") 
ggplot(Walker_RT_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Average Reaction Time") + ggtitle("RTs of Walker Parents") 
ggplot(NonParent_RT_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Average Reaction Time") + ggtitle("RTs of Non-Parents")
ggplot(RT_MeansByCond, aes(x=mobility, y = mean, group = baby_mobility, color = baby_mobility)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Average Reaction Time") 
```

```{r RTtest2, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_RT2 <- lmer(timesincecarstart ~  baby_mobility + (1|id), data = JustRTs)
```

```{r RTtestemmeans2, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_RT2, "baby_mobility", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of parental status")
```

#### RT predicted by virtual baby x parental interaction

```{r RTtest, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_RT3 <- lmer(timesincecarstart ~  mobility * baby_mobility + (1 |id), data = JustRTs)
lm_RT4 <- lmer(timesincecarstart ~  mobility + baby_mobility + (1 |id), data = JustRTs)
```
**Description**: Regression model where RT is predicted by interaction of trial block and parental status including random effects of block and ID.

```{r RTtestemmeans3, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_RT3, "mobility", by="baby_mobility", contr="pairwise", infer=TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in mobility estimates by parental status")
emmeans(lm_RT3, "baby_mobility", by="mobility", contr="pairwise", infer=TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in mobility estimates by parental status")


ref_RT <- ref_grid(lm_RT3,at=list(timesincecarstart=c(0,1)))
contrast(ref_RT, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Interaction between mobility and parental status")

anova(lm_RTnull, lm_RT3)
anova(lm_RTnull, lm_RT2)
anova(lm_RTnull, lm_RT1) 
anova(lm_RT4, lm_RT2)
anova(lm_RT4, lm_RT1) 
anova(lm_RT1, lm_RT2)
anova(lm_RT3, lm_RT4)

library(sjstats) #for eta squared effect sizes
library(pwr)
anova_stats(lm_RT1)

```

```{r poweranalysis, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
#calculate power (used for power analyses in grant writing)
#needs to be manually run for now

anova(lm_RT3)
F_to_eta2(2.6992, 3, 829.37) #calculate eta2 from f-ratio
sqrt(0.00967)/(1-0.00967) #calculate cohen's f from eta2
```

#### Non-Parametric Follow-up

*Hidden code* the following steps were taken to prepare the data:

* create new columns: (NoBaby-Sit), (Sit-Crawl), (Crawl-Walk), (Walk-NoBaby)
* get absolute magnitude (slope magnitude; regression)
* assess in binary "is block#-# smaller/larger than 0?" (sign test; logistic regression)

```{r RTNP, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
RT_means <- NPJustRTs %>%
  group_by(id, baby_mobility, mobility) %>%
  summarise(Means = mean(timesincecarstart))%>%
  spread(mobility, Means) %>%
  mutate(None2Sit = nobaby-precrawler) %>%
  mutate(Sit2Crawl = precrawler-crawler) %>%
  mutate(Crawl2Walk = crawler-walker) %>%
  mutate(Walk2None = walker-nobaby) %>%
  na.omit(.)

#absolute change test
RT_means$abs_None2Sit <- abs(RT_means$None2Sit)
RT_means$abs_Sit2Crawl <- abs(RT_means$Sit2Crawl)
RT_means$abs_Crawl2Walk <- abs(RT_means$Crawl2Walk)
RT_means$abs_Walk2None<- abs(RT_means$Walk2None)

#sign test
RT_means$binary_None2Sit <- cut(RT_means$None2Sit, c(-100,0,100), labels = c(0,1))
RT_means$binary_Sit2Crawl <- cut(RT_means$Sit2Crawl, c(-100,0,100), labels = c(0,1))
RT_means$binary_Crawl2Walk <- cut(RT_means$Crawl2Walk, c(-100,0,100), labels = c(0,1))
RT_means$binary_Walk2None <- cut(RT_means$Walk2None, c(-100,0,100), labels = c(0,1))

```

```{r RTNPtests, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
# #binary signs test
t1 <- glm(RT_means$binary_None2Sit ~ RT_means$baby_mobility, family = binomial) #ns
t2<- glm(RT_means$binary_Sit2Crawl ~ RT_means$baby_mobility, family = binomial) #ns
t3 <- glm(RT_means$binary_Crawl2Walk ~ RT_means$baby_mobility, family = binomial) #p=0.0483 walkers (walkers-crawlers)
t4 <- glm(RT_means$binary_Walk2None ~ RT_means$baby_mobility, family = binomial) #ns



#slope magnitude test
t5<- lm(RT_means$abs_None2Sit ~ RT_means$baby_mobility) #p=0.0251 pre-crawlers & 0.0495 for walkers (compared to crawl)
t6<- lm(RT_means$abs_Sit2Crawl ~ RT_means$baby_mobility) #0.0382 non-parents & 0.0470 for pre-crawlers 
t7<- lm(RT_means$abs_Crawl2Walk ~ RT_means$baby_mobility) #0.0382 " " & 0.0470 " "
t8<- lm(RT_means$abs_Walk2None ~ RT_means$baby_mobility) #0.0251 (pre-crawl) & "0.0494" (walkers)
```

```{r RTNPtests2, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
ref_RT1 <- ref_grid(t1)
contrast(ref_RT1, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from No VB to Precrawling VB")
ref_RT2 <- ref_grid(t2)
contrast(ref_RT2, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from Precrawling to Crawling VB")
ref_RT3 <- ref_grid(t3)
contrast(ref_RT3, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from Crawling to walking VB")
ref_RT4 <- ref_grid(t4)
contrast(ref_RT4, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from Walking to no VB")

ref_RT5 <- ref_grid(t5)
contrast(ref_RT5, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from No VB to Precrawling VB")
ref_RT6 <- ref_grid(t6)
contrast(ref_RT6, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from Precrawling to Crawling VB")
ref_RT7 <- ref_grid(t7)
contrast(ref_RT7, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from Crawling to walking VB")
ref_RT8 <- ref_grid(t8)
contrast(ref_RT8, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from Walking to no VB")
```  

### Speed Estimates (Threat *Distortion*)
**Description**: The car speeds in the raw data reflect the time needed to travel 250 units (unit = approx 1ft). This is why they don't read as 30-70 mph in the raw output. In the pilot data, I used to relabel these levels, but I don't anymore since the speeds now are being measured as likert responses. In other words, I cannot compare estimate speed to actual speed anymore, but rather I can only compare between conditions.

*Hidden code*: To describe the following

* Double check that estimated speeds weren't collected more than once per trial (e.g. in a double-recording event due to recording lag)

```{r isolatingtrueestimates, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
df_estimates <- df %>% filter(eventname == "Estimated Speed")
df_uniqueests <- df_estimates %>% distinct(eventname, uniquecode, .keep_all = TRUE)
df_estdupes <- df_estimates[!df_estimates$xtra_uniquecode %in% df_uniqueests$xtra_uniquecode,]
df <- df[!df$xtra_uniquecode %in% df_estdupes$xtra_uniquecode,]
df <- df[df$uniquecode %in% df_estimates$uniquecode,]
```

```{r speedrepresent, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
JustSpeeds <- df %>% filter(eventname == "Estimated Speed")
JustSpeeds$responsename <- as.numeric(JustSpeeds$responsename)

JustSpeeds %>% 
  group_by(baby_mobility, mobility) %>% 
  summarise(AverageSpeed = mean(responsename)) %>% 
  kable(.,digits = 3, caption = "Average Speed Estimate (Likert Score)" )
ggplot(JustSpeeds, aes(x=mobility, y = responsename, fill = baby_mobility)) + geom_boxplot()

JustSpeeds %>% 
  group_by(baby_mobility) %>% 
  summarise(AverageSpeed = mean(responsename)) %>% 
  kable(.,digits = 3, caption = "Average Speed Estimate (Likert Score)" )
```

#### Stimuli checks

Checking scale bias (centralizing response bias)
```{r speedgraph1, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
ggplot(JustSpeeds, aes(x=responsename, color = baby_mobility)) + 
  geom_density() + xlab("Estimated Speed (Likert)")  + 
  ggtitle("Distribution of Speed Estimates Overlap Between Conditions")

```

**Description**: Code to look at how the actual stim presentation compared to the intended programmed presentation
 
*Hidden code*: To describe the following

* Comparing presentation speed to programmed speed
* Collapsing the likert range to correspond to speed range

```{r actualspeed, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
#special test to figure out if timing events actually match car speeds (comment out when not in use)
#there are 258.81 ft in the car path (258.81 ft/s = 176 mph)
#dividing the ft/s speed (carspeed) by 1.467 should equal the mph speed
#258/timesincecarstart  / 1.467 = carspeed? lets test
df$programmedMPH <- recode(df$carspeed, "44"="30", "59"="40", "73"="50", "88"="60", "103"="70")
stim_pres_check <- df %>% filter(eventname == "Car Ends" | eventname == "Car Starts") %>% 
  mutate(timesincecarstart = timenow - lag(timenow, default = first(timenow))) %>%  
  mutate(msmph = (258/timesincecarstart)/1.467) %>% filter(eventname == "Car Ends")

ggplot(stim_pres_check, aes(x = msmph, fill=programmedMPH)) + geom_density(alpha=0.50) + xlim(list=c(25,75)) +
  ylab("MPH based on actual timing logs") + xlab("MPH based on programmed speed")

```


#### Speed predicted by virtual baby presence/type
```{r speedgraph2, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
Speed.se.summary <- JustSpeeds %>% 
  group_by(mobility, baby_mobility) %>% #within block and subject and parental status
  summarise(
    sd = sd(responsename),
    se = sqrt(var(responsename)/length(responsename)),
    mean = mean(responsename)) %>% 
  mutate(relabeled_groups = fct_recode(mobility, 
                                       "No Baby (Tutorial)" = "nobaby", 
                                       "Precrawling Infant" = "precrawler", 
                                       "Crawling Infant" = "crawler", 
                                       "Walking Infant" = "walker")) %>% 
  mutate(relabeled_groups = fct_relevel(relabeled_groups, 
                                        "No Baby (Tutorial)", 
                                        "Precrawling Infant",
                                        "Crawling Infant",
                                        "Walking Infant"
                                        ))


plot <- ggplot(Speed.se.summary, aes(x=relabeled_groups, y = mean, ymin = mean-se, ymax = mean+se, group = baby_mobility, color = baby_mobility)) +
  geom_line(sieze = 1) + geom_point(size = 2) + 
  xlab("Virtual Infant Condition") + 
  ylab("Average Speed Estimates (Likert Scale)")

plot
plot + geom_errorbar(width = 0.2)


plot

Speed.se.summary3 <- JustSpeeds %>% 
  group_by(mobility, subcondition) %>% #within block and subject and parental status
  summarise(
    sd = sd(responsename),
    se = sqrt(var(responsename)/length(responsename)),
    mean = mean(responsename),
        alpha=0.05, 
    t=qt((1-alpha)/2 + .5, 
    length(JustSpeeds$responsename)-1), 
    CI=t*se)%>% 
  mutate(relabeled_groups = fct_recode(mobility, 
                                       "No Baby" = "nobaby", 
                                       "Precrawling" = "precrawler", 
                                       "Crawling" = "crawler", 
                                       "Walking " = "walker")) %>% 
  mutate(relabeled_groups = fct_relevel(relabeled_groups, 
                                        "No Baby", 
                                        "Precrawling",
                                        "Crawling",
                                        "Walking"
                                        ))

plot <- ggplot(Speed.se.summary3, aes(x=relabeled_groups, y = mean, color = subcondition, fill = subcondition)) + 
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = mean-CI, ymax = mean+CI), width = .2,
                position = position_dodge(.9), color = "black") + 
  xlab("Virtual Infant Condition") + 
  ylab("Average Speed Estimates (Likert Scale)") +
  scale_color_manual(name = "Parental Experience", values = c("blue", "goldenrod3")) +
    scale_fill_manual(name = "Parental Experience", values = c("blue", "goldenrod3")) +
  coord_cartesian(ylim=c(3,5)) +
    theme_classic() + 
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))
plot

JustSpeeds$gender <- as.factor(JustSpeeds$gender)
Speed.se.summary4 <- JustSpeeds %>% 
  group_by(gender, baby_mobility) %>% #within block and subject and parental status
  summarise(
    sd = sd(responsename),
    se = sqrt(var(responsename)/length(responsename)),
    mean = mean(responsename))

ggplot(Speed.se.summary4, aes(x=baby_mobility, y = mean, fill = gender)) + 
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = .2,
                position = position_dodge(.9)) + 
  xlab("Gender") + 
  ylab("Average Speed Estimates (Likert Scale)") +
  coord_cartesian(ylim=c(4,4.6)) +
    theme_classic() + 
  theme(axis.text=element_text(size=18), 
        axis.title=element_text(size=20,face="bold"), 
        legend.text=element_text(size=18),
        legend.title = element_text(size=20))

```
**Description**: Regression model where Speed Estimate is predicted by virtual infant mobility and random effects ID.

```{r speedtest1, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_speednull <- lmer(responsename ~ (1 |id), data = JustSpeeds)
lm_speed1 <- lmer(responsename ~ mobility + (1 |id), data = JustSpeeds)
```

```{r speedtestmeans1, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_speed1, "mobility", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Virtual Infant type")
```

#### Speed predicted by parental experience
 
```{r speedgraph3, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
#All for dem sweet sweet spaghetti plots
NonParent_Speed_MeansByID <- JustSpeeds %>% 
  filter(baby_mobility == "Non-Parent") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(responsename))
Precrawler_Speed_MeansByID <- JustSpeeds %>% 
  filter(baby_mobility == "Sit") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(responsename))
Crawler_Speed_MeansByID <- JustSpeeds %>% 
  filter(baby_mobility == "Crawl") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(responsename))
Walker_Speed_MeansByID <- JustSpeeds %>% 
  filter(baby_mobility == "Walk") %>% 
  group_by(id, mobility) %>% 
  summarize(mean = mean(responsename))
Speed_MeansByCond <- JustSpeeds %>% 
  group_by(baby_mobility, mobility) %>% 
  summarize(mean = mean(responsename))

ggplot(NonParent_Speed_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() 
ggplot(Precrawler_Speed_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Estimated Speed (Likert)") + ggtitle("Estimated Speeds Parent Participants") 
ggplot(Crawler_Speed_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Estimated Speed (Likert)") + ggtitle("Estimated Speeds Parent Participants") 
ggplot(Walker_Speed_MeansByID, aes(x=mobility, y = mean, group = id, color = id)) +
  geom_line() + geom_point() + 
  xlab("Condition") + ylab("Estimated Speed (Likert)") + ggtitle("Estimated Speeds Parent Participants") 
ggplot(Speed_MeansByCond, aes(x=mobility, y = mean, group = baby_mobility, color = baby_mobility)) +geom_line() + geom_point() + 
  xlab("Condition") + ylab("Estimated Speed (Likert)") + ggtitle("Estimated Speeds Between Parents and Non-Parents") 

```

**Description**: Regression model where Speed Estimate is predicted by the mobility of the parent's infant and a random effects of ID.

```{r speedtest2, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_speed2 <- lmer(responsename ~ baby_mobility + (1 |id), data = JustSpeeds)
```

```{r speedtestmeans2, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_speed2, "baby_mobility", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of parental status")
```
#### Speed predicted by virtual baby x parental interaction

**Description**: Regression model where Speed Estimate is predicted by the interaction of the virtual infant mobility with the mobility of the parent's infant. Random effects of ID are also controlled for.

```{r speedtest3, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_speed3 <- lmer(responsename ~ baby_mobility * mobility + (1 |id), data = JustSpeeds)

lm_speed4 <- lmer(responsename ~ baby_mobility + mobility + (1 |id), data = JustSpeeds)
```

```{r speedtestmeans3, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_speed3, "mobility", by="baby_mobility", contr="pairwise", infer=TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in mobility estimates by parental status")

ref_speed <- ref_grid(lm_speed3,at=list(responsename=c(0,1)))
contrast(ref_speed, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Interaction between mobility and parental status")

anova(lm_speednull, lm_speed3)
anova(lm_speednull, lm_speed2) #ns
anova(lm_speednull, lm_speed1) 
anova(lm_speed4, lm_speed2)
anova(lm_speed4, lm_speed1) #ns
anova(lm_speed1, lm_speed2)
anova(lm_speed3, lm_speed4)

anova_stats(lm_speed1)
```
#### Non-Parametric Follow-up

```{r SpeedNP, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
Speed_means <- JustSpeeds %>%
  group_by(id, baby_mobility, mobility) %>%
  summarise(Means = mean(responsename))%>%
  spread(mobility, Means) %>%
  mutate(None2Sit = nobaby-precrawler) %>%
  mutate(Sit2Crawl = precrawler-crawler) %>%
  mutate(Crawl2Walk = crawler-walker) %>%
  mutate(Walk2None = walker-nobaby) %>%
  na.omit(.)

#absolute change test
Speed_means$abs_None2Sit <- abs(Speed_means$None2Sit)
Speed_means$abs_Sit2Crawl <- abs(Speed_means$Sit2Crawl)
Speed_means$abs_Crawl2Walk <- abs(Speed_means$Crawl2Walk)
Speed_means$abs_Walk2None<- abs(Speed_means$Walk2None)

#sign test
Speed_means$binary_None2Sit <- cut(Speed_means$None2Sit, c(-100,0,100), labels = c(0,1))
Speed_means$binary_Sit2Crawl <- cut(Speed_means$Sit2Crawl, c(-100,0,100), labels = c(0,1))
Speed_means$binary_Crawl2Walk <- cut(Speed_means$Crawl2Walk, c(-100,0,100), labels = c(0,1))
Speed_means$binary_Walk2None <- cut(Speed_means$Walk2None, c(-100,0,100), labels = c(0,1))

```

```{r SpeedNPtests, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
#binary signs test
t1 <- glm(Speed_means$binary_None2Sit ~ Speed_means$baby_mobility, family = binomial) #ns
t2<- glm(Speed_means$binary_Sit2Crawl ~ Speed_means$baby_mobility, family = binomial) #ns
t3 <- glm(Speed_means$binary_Crawl2Walk ~ Speed_means$baby_mobility, family = binomial) #ns
t4 <- glm(Speed_means$binary_Walk2None ~ Speed_means$baby_mobility, family = binomial) #ns



#slope magnitude test
t5<- lm(Speed_means$abs_None2Sit ~ Speed_means$baby_mobility) #p=0.0472 nonparent (compared to crawler)
t6<- lm(Speed_means$abs_Sit2Crawl ~ Speed_means$baby_mobility) #0.0391 " "
t7<- lm(Speed_means$abs_Crawl2Walk ~ Speed_means$baby_mobility) #0.0053 walkers
t8<- lm(Speed_means$abs_Walk2None ~ Speed_means$baby_mobility) #ns
```

```{r SpeedNPtests2, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
ref_Speed1 <- ref_grid(t1)
contrast(ref_Speed1, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from No VB to Precrawling VB")
ref_Speed2 <- ref_grid(t2)
contrast(ref_Speed2, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from Precrawling to Crawling VB")
ref_Speed3 <- ref_grid(t3)
contrast(ref_Speed3, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from Crawling to walking VB")
ref_Speed4 <- ref_grid(t4)
contrast(ref_Speed4, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Binary test from Walking to no VB")

ref_Speed5 <- ref_grid(t5)
contrast(ref_Speed5, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from No VB to Precrawling VB")
ref_Speed6 <- ref_grid(t6)
contrast(ref_Speed6, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from Precrawling to Crawling VB")
ref_Speed7 <- ref_grid(t7)
contrast(ref_Speed7, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from Crawling to walking VB")
ref_Speed8 <- ref_grid(t8)
contrast(ref_Speed8, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Diff in Slope Magnitude from Walking to no VB")
```  

## Other Interesting Variables

### Picking up baby
**Description**: Code to look at how often participants picked up the baby and where the baby was when they did. (Notably, I had to make sure these events extended beyond those that were filtered for not being "true trials".)


```{r Bpresses, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
df_pretrues %>% filter(eventname == "B Pressed") %>% 
  group_by(babylocation, baby_mobility) %>% summarize(count = n()) %>% 
  kable(., digits = 2, caption = "Total B presses")
  #need to eliminate duplicates when they press space more than once

numberB <- df_pretrues %>% filter(eventname == "B Pressed") %>% 
  #need to eliminate duplicates when they press space more than once
  group_by(id, babylocation, baby_mobility) %>% summarize(count = n()) 
  
 numberB %>% 
   group_by(baby_mobility) %>% 
   summarize("Average" = mean(count)) %>% 
   kable(., digits = 2, caption = "Average B presses per subject across parental status")
 
numberB %>% 
  group_by(babylocation) %>% 
  summarize("Average B Presses Per Subject" = mean(count)) %>% 
  kable(., digits = 2, caption = "Average B presses per subject across baby location")
```


```{r Bpressessig, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
lm_Bpress <- lm(count ~ babylocation, data=numberB)
emmeans(lm_Bpress, "babylocation", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in Average No. of B Presses")

```
 

### Comparing Demographics and Determining Confounds

```{r democomparisons, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
reduced_demos <- df %>% 
  select(anxiety, depression, videogames, relationship, age, gender, race, primary_language, number_children, baby_mobility, breastfeed, id, subcondition, baby_mobility) %>% 
  group_by(id) %>% unique()

#comparing difference between groups
lm_anxiety <- lm(anxiety ~ baby_mobility, data = reduced_demos)
lm_depression <- lm(depression ~ baby_mobility, data = reduced_demos)

emmeans(lm_anxiety, "baby_mobility", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Comparing Anxiety Between Parents and NonParents")
emmeans(lm_depression, "baby_mobility", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Comparing Depression Between Parents and NonParents")

#predicting RTs
lm_RT.anxiety <- lmer(timesincecarstart ~ anxiety + (1|id), data = JustRTs)
lm_RT.depression <- lmer(timesincecarstart ~ depression + (1|id), data = JustRTs)
lm_RT.race <- lmer(timesincecarstart ~ race + (1|id), data = JustRTs)
lm_RT.age <- lmer(timesincecarstart ~ age + (1|id), data = JustRTs)
lm_RT.relationship <- lmer(timesincecarstart ~ relationship + (1|id), data = JustRTs)
lm_RT.videogames <- lmer(timesincecarstart ~ videogames + (1|id), data = JustRTs)

lm_RT.mobility <- lmer(timesincecarstart ~ baby_mobility + (1|id), data = JustRTs)
lm_RT.breastfeed <- lmer(timesincecarstart ~ breastfeed + (1|id), data = JustRTs)
lm_RT.kids <- lmer(timesincecarstart ~ number_children + (1|id), data = JustRTs)

lm_RT.gender<-lmer(timesincecarstart ~ gender + (1|id), data = JustRTs)

#make a smaller table of just p-values and only show those greater than 0.05
summary2 <- matrix(c((summary(lm_RT.anxiety)$coef[2,5]), 
                     (summary(lm_RT.depression)$coef[2,5]),
                     (summary(lm_RT.race)$coef[2,5]),
                     (summary(lm_RT.relationship)$coef[2,5]),
                     (summary(lm_RT.age)$coef[2,5]),
                     (summary(lm_RT.mobility)$coef[2,5]),
                     (summary(lm_RT.breastfeed)$coef[2,5]),
                     (summary(lm_RT.kids)$coef[2,5]), 
                     (summary(lm_RT.gender)$coef[2,5])), byrow = TRUE)
colnames(summary2) <- c("P-values")
rownames(summary2) <- c("~anxiety", "~depression", "~race", "~relationship", "~age", "~child mobility", "~breastfeed", "~number of kids", "~gender")
summary2 %>% kable(., caption = "Summary of p-values for RT predicted by each demo")

#predicting speed
lm_Speed.anxiety <- lmer(responsename ~ anxiety + (1|id), data = JustSpeeds)
lm_Speed.depression <- lmer(responsename ~ depression + (1|id), data = JustSpeeds)
lm_Speed.race <- lmer(responsename ~ race + (1|id), data = JustSpeeds)
lm_Speed.age <- lmer(responsename ~ age + (1|id), data = JustSpeeds)
lm_Speed.relationship <- lmer(responsename ~ relationship + (1|id), data = JustSpeeds)
lm_Speed.videogames <- lmer(responsename ~ videogames + (1|id), data = JustSpeeds)

lm_Speed.mobility <- lmer(responsename ~ baby_mobility + (1|id), data = JustSpeeds)
lm_Speed.breastfeed <- lmer(responsename ~ breastfeed + (1|id), data = JustSpeeds)
lm_Speed.kids <- lmer(responsename ~ number_children + (1|id), data = JustSpeeds)

lm_Speed.gender<-lmer(responsename ~ gender + (1|id), data = JustSpeeds)
lm_Speed.gender.parent<-lmer(responsename ~ gender*baby_mobility + (1|id), data = JustSpeeds)


#make a smaller table of just p-values and only show those greater than 0.05
summary3 <- matrix(c((summary(lm_Speed.anxiety)$coef[2,5]), 
                     (summary(lm_Speed.depression)$coef[2,5]),
                     (summary(lm_Speed.race)$coef[2,5]),
                     (summary(lm_Speed.relationship)$coef[2,5]),
                     (summary(lm_Speed.age)$coef[2,5]),
                     (summary(lm_Speed.mobility)$coef[2,5]),
                     (summary(lm_Speed.breastfeed)$coef[2,5]),
                     (summary(lm_Speed.kids)$coef[2,5]),
                     (summary(lm_Speed.gender)$coef[2,5])), byrow = TRUE)
colnames(summary3) <- c("P-values")
rownames(summary3) <- c("~anxiety", "~depression", "~race", "~relationship", "~age", "~child mobility", "~breastfeed", "~number of kids", "~gender")
summary3 %>% kable(., caption = "Summary of p-values for Speed predicted by each demo")
```


#### Effect of general parental status

```{r parenttests, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
lm_RT_parent <- lmer(timesincecarstart ~  subcondition + (1|id), data = JustRTs)
lm_speed_parent <- lmer(responsename ~  subcondition + (1|id), data = JustSpeeds)
```

```{r parenttestemmeans, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_RT_parent, "subcondition", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Parenting on RT")
summary(lm_RT_parent) 
  
emmeans(lm_speed_parent, "subcondition", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Parenting on Speed Estimate")
summary(lm_speed_parent) 

library(MuMIn) #to get effect sizes (thought I guess I don't need it since it's not sig)
r.squaredGLMM(lm_RT_parent)
r.squaredGLMM(lm_speed_parent)
```

#### Effect of gender explored

```{r gendertests, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
lm_RT_gender <- lmer(timesincecarstart ~  gender + (1|id), data = JustRTs)
lm_speed_gender <- lmer(responsename ~  gender + (1|id), data = JustSpeeds)

lm_speed_gender2 <- lmer(responsename ~  gender*baby_mobility + (1|id), data = JustSpeeds)
lm_speed_gender3 <- lmer(responsename ~  gender*mobility + (1|id), data = JustSpeeds)
lm_speed_gender4 <- lmer(responsename ~  gender+baby_mobility+mobility + (1|id), data = JustSpeeds)
```

```{r gendertestemmeans, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_RT_gender, "gender", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Gender on RT")
  
emmeans(lm_speed_gender, "gender", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Gender on Speed Estimate")

emmeans(lm_speed_gender2, "gender", by="baby_mobility", contr="pairwise", infer=TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in mobility estimates by parental status")
emmeans(lm_speed_gender3, "gender", by="mobility", contr="pairwise", infer=TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in mobility estimates by parental status")

anova(lm_speed_gender, lm_speed_gender2)
anova(lm_speed_gender, lm_speed_gender3)
anova(lm_speed_gender3, lm_speed_gender2)
anova_stats(lm_speed_gender4)
```

#### Effect of parity explored

```{r paritytests, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
#need to recode parity first
JustRTs$number_children <- recode(JustRTs$number_children , 
                                  "1"="primi", "1.5"="multi","2"= "multi","3"="multi", "4"="multi","6"="multi","One, although we plan for more down the line. (3 Probably)"="primi",) %>% na_if("") %>% as.character(.) %>% replace_na(., "null") %>% as.factor(.)


JustSpeeds$number_children <- recode(JustSpeeds$number_children , 
                                  "1"="primi", "1.5"="multi","2"= "multi","3"="multi", "4"="multi","6"="multi","One, although we plan for more down the line. (3 Probably)"="primi",) %>% na_if("") %>% as.character(.) %>% replace_na(., "null") %>% as.factor(.)

JustRTs$number_children <- as.factor(JustRTs$number_children)
JustSpeeds$number_children <- as.factor(JustSpeeds$number_children)

lm_RT_parity <- lmer(timesincecarstart ~  number_children + (1|id), data = JustRTs)
lm_speed_parity <- lmer(responsename ~  number_children  + (1|id), data = JustSpeeds)
```

```{r paritytestemmeans, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_RT_parity, "number_children", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Gender on RT")
  
emmeans(lm_speed_parity, "number_children", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Gender on Speed Estimate")
```

#### Effect of nursing status explored

```{r filterfemale, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
FemaleParentsRTs <- JustRTs %>% filter(gender == 2) %>% filter(subcondition == "Parent")
FemaleParentsSpeeds <- JustSpeeds %>% filter(gender == 2) %>% filter(subcondition == "Parent")
```

```{r nursingtest, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
lm_RT_nursing <- lmer(timesincecarstart ~  breastfeed + (1|id), data = FemaleParentsRTs)
lm_speed_nursing <- lmer(responsename ~  breastfeed  + (1|id), data = FemaleParentsSpeeds)
```

```{r nursingtestemmeans, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
emmeans(lm_RT_nursing, "breastfeed", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Nursing on RT (female only)")
  
emmeans(lm_speed_nursing, "breastfeed", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Nursing on Speed Estimate (female only)")
```



#### Effect of state anxiety/depression explored

```{r depressiontests,include=FALSE, echo = FALSE, message=FALSE, warning=FALSE}
lm_RT_depression <- lmer(timesincecarstart ~  depression + (1|id), data = JustRTs) #ns
lm_speed_depression <- lmer(responsename ~  depression  + (1|id), data = JustSpeeds) #ns
```

```{r anxietytests, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_RT_anxiety <- lmer(timesincecarstart ~  anxiety + (1|id), data = JustRTs) #ns
lm_speed_anxiety <- lmer(responsename ~  anxiety  + (1|id), data = JustSpeeds) #ns
```

#### The effect of infant exposure over time (without counterbalancing)
Without going in and handcoding, I don't have a way to relabel the blocks in order of exposure. Instead, I should make X time, and then center it around the event of first baby exposure. 

```{r lineartime, include=FALSE, echo = FALSE, message=FALSE, warning=FALSE, cache = TRUE}
#finding the line where the baby was first introduced
df_firsts <- df_pretrues %>% distinct (id, blockname, .keep_all = TRUE) %>% 
  filter(blockname == "6.BabyScene") %>% 
  #make timenow a static column so that it is always true
  mutate("stabletime" = timenow)

#making that line time 0
#merging it back into a new dataset
df_linear <- df_pretrues %>% add_column(stabletime = 0,)

for(i in 1:dim(df_linear[1])){
  for(j in 1:dim(df_firsts[1])){
    if(df_linear$id[i] == df_firsts$id[j]){
      df_linear$stabletime[i] = df_firsts$stabletime[j] 
    }
  }
}
#making a new column to subtract all of timenow from stabletime
df_linear <- df_linear %>% mutate("newtime" = timenow - stabletime)

#note: i probably can go back and identify the blocks automatically if i somehow take the score data and transfer that into trial information
#let's try filtering to only first score presses getting trial and score data from that
df_unique_trials <- df_linear %>%  filter(eventname == "Score (Space Pressed)") %>% 
  distinct (id, responsename, .keep_all = TRUE) %>% 
  mutate("uniquetrial" = responsename)
#if it shares a unique code, its in the same trial
#go back and add a column and remerge
df_linear2 <- df_linear %>% add_column("uniquetrial" = NA)

for(i in 1:dim(df_linear2[1])){
  for(j in 1:dim(df_unique_trials[1])){
    if(df_linear2$uniquecode[i] == df_unique_trials$uniquecode[j]){
      df_linear2$uniquetrial[i] = df_unique_trials$uniquetrial[j] 
    }
  }
}

#well that worked surprisingly well..so let's try dividing it into blocks
df_linear2$uniquetrial <- as.numeric(df_linear2$uniquetrial)
l1 <-df_linear2 %>% filter(uniquetrial <= 5) %>% add_column("block" = 0)
l2 <-df_linear2 %>% filter(uniquetrial > 5) %>% filter(uniquetrial <= 15) %>% add_column("block" = 1)
l3 <-df_linear2 %>% filter(uniquetrial > 15) %>% filter(uniquetrial <= 25) %>% add_column("block" = 2)
l4 <-df_linear2 %>% filter(uniquetrial > 25) %>% add_column("block" = 3)
df_linear3 <- rbind(l1, l2, l3, l4)

#now to get all that info without needing to go through the process of recreating JustRTs and JustSpeeds
JustRTs2 <- JustRTs %>% add_column("block" = NA)
JustSpeeds2 <- JustSpeeds %>% add_column("block" = NA)
for(i in 1:dim(JustRTs2[1])){
  for(j in 1:dim(df_linear3[1])){
    if(JustRTs2$uniquecode[i] == df_linear3$uniquecode[j]){
      JustRTs2$block[i] = df_linear3$block[j] 
    }
  }
}
for(i in 1:dim(JustSpeeds2[1])){
  for(j in 1:dim(df_linear3[1])){
    if(JustSpeeds2$uniquecode[i] == df_linear3$uniquecode[j]){
      JustSpeeds2$block[i] = df_linear3$block[j] 
    }
  }
}

```

```{r lineartimetests, include=TRUE, echo = FALSE, message=FALSE, warning=FALSE}
RT.se.summary2 <- JustRTs2 %>% 
  group_by(block, baby_mobility) %>% #within block and subject and parental status
  summarise(
    sd = sd(timesincecarstart),
    se = sqrt(var(timesincecarstart)/length(timesincecarstart)),
    mean = mean(timesincecarstart)) %>% 
   drop_na(block)
RT.se.summary2$block <- as.factor(RT.se.summary2$block)
RT.se.summary2 <- RT.se.summary2 %>% 
  mutate(relabeled_blocks = fct_recode(block, 
                                       "No Infant" = "0",
                                       "First Infant" = "1",
                                       "Second Infant" = "2",
                                       "Third Infant" ="3")) %>%
  mutate(relabeled_blocks = fct_relevel(relabeled_blocks,
                                        "No Infant",
                                        "First Infant",
                                        "Second Infant",
                                        "Third Infant"))

ggplot(RT.se.summary2, aes(x=relabeled_blocks, y = mean, ymin = mean-se, ymax = mean+se, group = baby_mobility, color = baby_mobility)) +
  geom_line() + geom_point() + 
  geom_errorbar(width = 0.2) +
  xlab("Condition") + ylab("Average Reaction Time (s)") +
  scale_color_manual(name = "mobility", 
                    values = c("green", "black", "red", "blue")) +
  theme_light() 


lm1_RT <- lmer(timesincecarstart ~  block + (1|id), data = JustRTs2)
emmeans(lm1_RT, "block", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Infant Exposure (generic)")
anova_stats(lm1_RT)

Speed.se.summary2 <- JustSpeeds2 %>% 
  group_by(block, baby_mobility) %>% #within block and subject and parental status
  summarise(
    sd = sd(responsename),
    se = sqrt(var(responsename)/length(responsename)),
    mean = mean(responsename)
  ) %>% 
  drop_na(block)
Speed.se.summary2$block <- as.factor(Speed.se.summary2$block)
Speed.se.summary2 <- Speed.se.summary2 %>% 
  mutate(relabeled_blocks = fct_recode(block, 
                                       "No Infant" = "0",
                                       "First Infant" = "1",
                                       "Second Infant" = "2",
                                       "Third Infant" ="3")) %>%
  mutate(relabeled_blocks = fct_relevel(relabeled_blocks,
                                        "No Infant",
                                        "First Infant",
                                        "Second Infant",
                                        "Third Infant"))

ggplot(Speed.se.summary2, aes(x=relabeled_blocks, y = mean, ymin = mean-se, ymax = mean+se, group = baby_mobility, color = baby_mobility)) +
  geom_line() + geom_point() + 
  geom_errorbar(width = 0.2) +
  xlab("Condition") + ylab("Average Reaction Time")

JustSpeeds2$block <- as.factor(JustSpeeds2$block)
lm1_Speed <- lmer(responsename~  block + (1|id), data = JustSpeeds2)
emmeans(lm1_Speed, "block", contr = "pairwise", infer =TRUE)$contrast %>% 
  kable(., digit=3, caption = "Average effect of Infant Exposure (generic)")


lm2_RT <- lmer(timesincecarstart ~  block*baby_mobility + (1|id), data = JustRTs2)
lm2_Speed <- lmer(responsename~  block*baby_mobility + (1|id), data = JustSpeeds2)

emmeans(lm2_RT, "block", by="baby_mobility", contr="pairwise", infer=TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in mobility estimates by parental status")
ref_RT2 <- ref_grid(lm2_RT,at=list(timesincecarstart=c(0,1)))
contrast(ref_RT2, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Interaction between mobility and parental status")

emmeans(lm2_Speed, "block", by="baby_mobility", contr="pairwise", infer=TRUE)$contrast %>% 
  kable(., digit=3, caption = "Difference in mobility estimates by parental status")
ref_RT2 <- ref_grid(lm2_Speed,at=list(responsename=c(0,1)))
contrast(ref_RT2, interaction = "pairwise") %>% 
  kable(., digit=3, caption = "Interaction between mobility and parental status")

lmspeed_blockXmobility<-lmer(responsename ~ block * mobility + (1|id), data = JustSpeeds2)
anova(lmspeed_blockXmobility, lm1_Speed)
anova_stats(lm1_Speed)
anova_stats(lmspeed_blockXmobility)

lmRT_blockXmobility<-lmer(timesincecarstart ~  block + mobility + (1|id), data = JustRTs2)
anova(lmRT_blockXmobility, lm1_RT)
anova_stats(lm1_RT)
anova_stats(lmRT_blockXmobility)
```


## Follow-ups 

### controlling for mood

```{r moodcontrols, include=TRUE, echo = TRUE, message=FALSE, warning=FALSE}
lm_SpeedxD <- lmer(responsename ~ baby_mobility * mobility + depression+ (1 |id), data = JustSpeeds)
lm_RTxD <- lmer(timesincecarstart ~ baby_mobility * mobility + depression + (1 |id), data = JustRTs)

lm_SpeedxA <- lmer(responsename ~ baby_mobility * mobility + anxiety+ (1 |id), data = JustSpeeds)
lm_RTxA <- lmer(timesincecarstart ~ baby_mobility * mobility + anxiety+ (1 |id), data = JustRTs)
```

